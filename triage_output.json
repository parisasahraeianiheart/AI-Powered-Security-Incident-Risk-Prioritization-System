{
  "run": {
    "model": "xgboost",
    "mode": "min_cost",
    "cost_model": {
      "C_FP": 1.0,
      "C_FN": 20.0
    },
    "baseline_threshold": 0.5,
    "threshold_selected": 0.064
  },
  "metrics_at_threshold": {
    "threshold": 0.064,
    "tn": 21366,
    "fp": 15634,
    "fn": 0,
    "tp": 45332,
    "precision": 0.7435619853688942,
    "recall": 1.0,
    "fpr": 0.4225405405405405
  },
  "top_alerts": [
    {
      "idx": 13182,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=18, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 12521,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=15, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 12525,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=15, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 13486,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=18, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 13491,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=18, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 22401,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=18, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 22400,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=18, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 22287,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=18, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 13483,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=18, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    },
    {
      "idx": 12529,
      "p": 0.9999887943267822,
      "decision": "ESCALATE",
      "explanation": "Risk score p=1.000 driven by network behavior/volume/TTL signals. Top observed signals (raw feature values): sttl=254, ct_state_ttl=2, sbytes=114, ct_dst_sport_ltm=15, ct_srv_src=45, dload=0.0",
      "suggested_actions": [
        "Validate TTL consistency (possible spoofing / scanning artifacts).",
        "Check repeated connections to same service/port (scan/bruteforce patterns).",
        "Inspect unusual traffic volume/throughput (possible exfil/C2)."
      ]
    }
  ],
  "llm": {
    "enabled": true,
    "model": "gpt-4o-mini",
    "brief": "### Executive Summary\nThe alert queue indicates multiple high-risk network behaviors, all with a risk score of 1.000, suggesting potential spoofing, scanning, or exfiltration activities. The alerts are primarily driven by unusual Time to Live (TTL) values, repeated connections to specific services/ports, and abnormal traffic volume. Immediate action is required to validate these behaviors and mitigate potential threats.\n\n### Prioritized Recommended Analyst Actions\n- Validate TTL consistency to identify possible spoofing or scanning artifacts.\n- Check for repeated connections to the same service/port to detect potential scanning or brute-force patterns.\n- Inspect unusual traffic volume and throughput to assess possible data exfiltration or command-and-control (C2) activities.\n- Review logs associated with the top alerts for additional context and corroboration.\n- Document findings and actions taken for each alert to maintain a clear audit trail.\n\n### Escalation Criteria\n- If any of the validated alerts show confirmed malicious activity.\n- If there is a significant increase in traffic volume or unusual patterns that persist after initial investigation.\n- If multiple alerts correlate with known threat indicators or previous incidents.\n\n### Key Questions / Data to Pull Next\n- What are the historical traffic patterns for the affected services/ports?\n- Are there any known vulnerabilities associated with the services being targeted?\n- What are the source IP addresses for the alerts, and do they match any known malicious IP lists?\n- Are there any other alerts or incidents occurring concurrently that may indicate a coordinated attack?\n- What are the specific user accounts or systems involved in the flagged connections?",
    "error": null
  }
}